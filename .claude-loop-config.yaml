# Claude-Loop Configuration for Epiloop Integration
# Optimized for maximum parallelization and comprehensive logging

execution:
  maxIterations: 10
  delaySeconds: 1
  parallel:
    enabled: true
    maxPRDs: 5
    workerThreads: 5

quality:
  requireTests: true
  requireTypecheck: true
  requireLint: true
  minCoverage: 75
  securityScan: true

# Reality-Grounded TDD (RG-TDD) Configuration
rgTdd:
  enabled: true
  enforceIronLaw: true  # Tests must fail before implementation
  layers:
    foundation:  # Layer 1: Traditional TDD
      enabled: true
      unitTests: true
      integrationTests: true
      typeChecks: true
      linting: true
    challenge:  # Layer 2: Edge cases and stress tests
      enabled: true
      edgeCaseTests: true
      scaleStressTests: true
      competitiveBaselines: true
      crossDomainTransfer: false  # Disabled for initial integration
    reality:  # Layer 3: Real-world validation
      enabled: true
      benchmarkEval: false  # Will enable after basic implementation
      adversarialTests: false  # Will enable in production phase
      userAcceptance: false  # Will enable after deployment
  tddEnforcer:
    scriptPath: "lib/tdd-enforcer.py"
    verifyRedPhase: true  # Verify tests fail before implementation
    blockGreenBeforeRed: true  # Block if implementation exists without failing test

agents:
  enabled: true
  maxAgentsPerIteration: 2
  enabledTiers: "1,2"
  maxTokensPerAgent: 2000

experience:
  enabled: true
  minHelpfulRate: 0.30
  maxExperiences: 5
  storePath: "~/.epiloop/claude-loop/experience-store"
  domainAware: true
  feedbackTracking: true

logging:
  enabled: true
  level: "debug"
  format: "jsonl"
  outputPath: "~/.epiloop/logs/claude-loop"
  includeMetrics: true
  rotationPolicy: "daily"

selfImprovement:
  enabled: true
  failureAnalysis: true
  patternDetection: true
  improvementQueue: true
  humanGating: true
  calibrationTracking: true

adaptiveSplitting:
  enabled: true
  complexityThreshold: 7
  signals:
    timeOverrun: 0.35
    fileExpansion: 0.25
    errorCount: 0.25
    clarifications: 0.15

multiLLM:
  enabled: true
  primaryProvider: "claude"
  reviewEnabled: false  # Disable for initial integration
  reviewThreshold: 7

metrics:
  enabled: true
  collectTokenUsage: true
  collectDuration: true
  collectSuccessRate: true
  collectFailureReasons: true
  exportFormat: "prometheus"
  exportPath: "~/.epiloop/metrics/claude-loop"

checkpoints:
  enabled: true
  frequency: "per-story"
  retentionDays: 30

workspace:
  basePath: "~/.epiloop/workspaces/claude-loop"
  useGitWorktree: true
  cleanupPolicy: "on-success"
  maxConcurrentWorkspaces: 5
